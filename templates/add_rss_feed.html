{% extends "base.html" %}

{% block title %}RSS Feeds{% endblock %}

{% block head %}
  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css">
{% endblock %}

{% block content %}
  <div class="pagetitle">
    <h1>RSS Feeds</h1>
    <nav>
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}">Home</a></li>
        <li class="breadcrumb-item active">RSS Feeds</li>
      </ol>
    </nav>
  </div>

  <section class="section">
    <div class="row">
      <!-- RSS Form -->
      <div class="col-lg-6">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Add New RSS Feed</h5>
            <form method="POST" action="{{ url_for('add_rss_feed') }}">
              <div class="mb-3">
                <label for="rss_url" class="form-label">RSS Feed URL</label>
                <input type="url" class="form-control" id="rss_url" name="url" placeholder="Enter RSS Feed URL" required>
              </div>
              <button type="submit" class="btn btn-primary">Add Feed</button>
            </form>
          </div>
        </div>
      </div>

      <!-- RSS Feeds Table -->
      <div class="col-lg-12">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Your RSS Feeds</h5>
            <table id="rssTable" class="table table-striped">
              <thead>
                <tr>
                  <th>#</th>
                  <th>URL</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for feed in user_feeds %}
                <tr>
                  <td>{{ loop.index }}</td>
                  <td>{{ feed.url }}</td>
                  <td>
                    <form method="POST" action="{{ url_for('delete_rss_feed', feed_id=feed.id) }}" style="display:inline;">
                      <button type="submit" class="btn btn-danger btn-sm">Delete</button>
                    </form>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
{% endblock %}

{% block scripts %}
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#rssTable').DataTable({
        paging: true,
        ordering: true,
        searching: true,
        pageLength: 5,
        lengthMenu: [5, 10, 20, 50],
        language: {
          search: "Filter RSS Feeds:",
          lengthMenu: "Show _MENU_ feeds per page",
          info: "Showing _START_ to _END_ of _TOTAL_ feeds",
          paginate: {
            next: "Next",
            previous: "Previous"
          },
        },
      });
    });
  </script>
{% endblock %}